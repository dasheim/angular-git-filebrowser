<style>
    .dropzonehighlight {
        border: #155D97 dashed 5px;
        border-radius: 20px;
        background-color: rgba(255,255,255,0.8);
        text-align: center;
    }
    .overdropzone {
        border: #5D9715 solid 5px;        
    }
    </style>
<div style="display: flex; flex-direction: column; width: 100%; height: 100%">
    <div>
    <mat-toolbar style="width: 100%; display: flex;">
        <h3>
            Files
        </h3>
        <span style="flex-grow: 1"></span>
        <button mat-icon-button (click)="attachFilesClicked()" mdTooltip="Select a file from your computer and upload">
            <mat-icon>file_upload</mat-icon>
        </button>
        <input #attachmentFileUploadInput type="file" [hidden]="true" multiple (change)="onFilesSelected($event)" />
    </mat-toolbar>
    </div>
    <mat-progress-bar *ngIf="uploadprogress!=null" style="width: 100%"
            mode="determinate"
            [value]="uploadprogress"
        >
    </mat-progress-bar>        
    <div
        *ngIf="showDropZone"
        style="flex-grow: 1"
        [ngClass]="{'dropzonehighlight': showDropZone, 'overdropzone': draggingOverDropZone}" 
        (dragover)="draggingOverDropZone=true" 
        (dragleave)="draggingOverDropZone=false" 
        (drop)="dropFiles($event)">
        <h1>Drop files here</h1>                              
    </div>
    
    <div style="overflow-y: auto; flex-grow: 1" *ngIf="!showDropZone">
        <mat-nav-list *ngIf="!hasImages">
            <mat-list-item *ngFor="let file of filebrowserservice.fileList | async">
                <!-- <img *ngIf="file.isImage" matListAvatar  /> -->
                <a mat-line target="_blank" mdTooltip="Download file">{{file}}</a>
                
                <button mat-icon-button mdTooltip="Delete file" (click)="deleteFile(file)">
                    <mat-icon>delete</mat-icon>
                </button>

            </mat-list-item>
        </mat-nav-list>    
        <mat-grid-list *ngIf="hasImages" cols="2" rowHeight="2:1">
            <mat-grid-tile *ngFor="let file of fileList">
                <img *ngIf="file.isImage" matListAvatar [src]="'/PetrusFileManager/DownloadFileServlet?id='+file.fileId+'&remoteAuthToken='+fileManagerService.remoteAuthToken" />
                <mat-icon *ngIf="!file.isImage">attachment</mat-icon>
                <mat-grid-tile-footer style="display: flex">
                    <a mat-button target="_blank" mdTooltip="Download file" 
                        [href]="'/PetrusFileManager/DownloadFileServlet?id='+file.fileId+'&remoteAuthToken='+fileManagerService.remoteAuthToken">
                        {{file.fileName}}
                    </a>
                    <span style="flex: 1 1 auto"></span>
                    <button mat-icon-button mdTooltip="Delete file" (click)="deleteFile(file)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </mat-grid-tile-footer>
            </mat-grid-tile>            
        </mat-grid-list>
    </div>
</div>